-- Must be run as superuser.
-- Assumes CSV has header rows and is separated by pipe.
-- File must be copied to the server and given read permission for all users
DROP TABLE IF EXISTS received.crashes_bike1;
CREATE TABLE received.crashes_bike1 (
    caseid TEXT,
    year TEXT,
    unittype_one TEXT,
    unittype_two TEXT,
    unittype_three TEXT,
    circumstance TEXT,
    primary_contrib TEXT,
    condition_1 TEXT,
    condition_2 TEXT,
    condition_3 TEXT,
    dirfromint TEXT,
    diroftravel_one TEXT,
    diroftravel_two TEXT,
    tdg_directions TEXT,
    dir_key TEXT,
    directions TEXT,
    bike_mvmt TEXT,
    veh_mvmt TEXT,
    comb_mvmt TEXT,
    comb_mvmt_sw TEXT,
    map_code TEXT,
    injury TEXT,
    diroftravel_three TEXT,
    disabled_st1 TEXT,
    disabled_st2 TEXT,
    contrib_1 TEXT,
    contrib_2 TEXT,
    contrib_3 TEXT,
    enteredby TEXT,
    entereddate TEXT,
    estvehspeed_one TEXT,
    estvehspeed_two TEXT,
    estvehspeed_three TEXT,
    feetfromint TEXT,
    firstharmful TEXT,
    mostharmful TEXT,
    secondharmful TEXT,
    internamedir TEXT,
    lightingcondition TEXT,
    location TEXT,
    masterid TEXT,
    precrashmaneuv_1 TEXT,
    precrashmaneuv_2 TEXT,
    precrashmaneuv_3 TEXT,
    node TEXT,
    numberinjured TEXT,
    numberoffatalities TEXT,
    pedaction_one TEXT,
    pedaction_two TEXT,
    pedaction_three TEXT,
    publicproperty TEXT,
    railroadcrossing TEXT,
    roadcondition TEXT,
    roadcontour TEXT,
    roaddescription TEXT,
    roadsurface TEXT,
    safetyequipmenthelmet_one TEXT,
    safetyequipmenthelmet_two TEXT,
    safetyequipmenthelmet_three TEXT,
    safetyequipsystem_one TEXT,
    safetyequipsystem_two TEXT,
    safetyequipsystem_three TEXT,
    safetyequipuse_one TEXT,
    safetyequipuse_two TEXT,
    safetyequipuse_three TEXT,
    speedlimit_one TEXT,
    speedlimit_two TEXT,
    speedlimit_three TEXT,
    street1 TEXT,
    street2 TEXT,
    streetname_st1 TEXT,
    streetname_st2 TEXT,
    street_intersection TEXT,
    totvehs TEXT,
    unitage_one TEXT,
    unitage_two TEXT,
    unitage_three TEXT,
    vehcomb_one TEXT,
    vehcomb_two TEXT,
    vehcomb_three TEXT,
    vehicledefect_one TEXT,
    vehicledefect_two TEXT,
    vehicledefect_three TEXT,
    technicaljudgement TEXT,
    notes TEXT,
    typology TEXT,
    same_dir TEXT,
    opp_dir TEXT,
    perpen TEXT,
    angle TEXT,
    notes2 TEXT,
    sw TEXT,
    ww_sw TEXT,
    cw_dwy_alley TEXT,
    day_week TEXT,
    weekday TEXT,
    trail_access TEXT,
    bike_s_veh_s_st_p TEXT,
    bike_s_veh_lt_St_od TEXT,
    bike_s_veh_rt_St_p TEXT,
    bike_s_veh_rt_St_sd TEXT,
    bike_s_veh_s_st_sd TEXT,
    bike_s_veh_rt_St_WW_p TEXT,
    bike_s_veh_s_sW_WW_p TEXT,
    bike_s_veh_rt_SW_WW_p TEXT,
    highspeed TEXT,
    injurycrash TEXT
);
ALTER TABLE received.crashes_bike1 OWNER TO gis;

-- copy data in
COPY received.crashes_bike1 FROM '/home/sgardner/2011-2012_Crash Data Typed.csv' DELIMITER '|' HEADER QUOTE '"' CSV;
